{"version":3,"file":"StressTest.stories-6824f3c8.js","sources":["../../stories/StressTest.tsx","../../stories/StressTest.stories.mdx"],"sourcesContent":["import React, {\n  useCallback,\n  useEffect,\n  useState,\n} from \"react\";\n\nimport addDays from \"date-fns/addDays\";\n\nimport { DndProvider } from \"react-dnd\";\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\n\nimport {\n  Gantt,\n  OnChangeTasks,\n  Task,\n  TaskOrEmpty,\n} from \"../src\";\n\nimport {\n  onAddTask,\n  onEditTask,\n} from \"./helper\";\n\nimport \"../dist/index.css\";\n\n// 4 * ()\n\ntype AppProps = {\n  numberOfRoots: number;\n  numberOfSubtasks: number;\n  depth: number;\n};\n\nconst initSubtasks = (\n  res: Task[],\n  parentId: string,\n  parentStartDate: Date,\n  parentName: string,\n  currentDepth: number,\n  numberOfSubtasks: number,\n  depth: number,\n) => {\n  const restDepth = depth - currentDepth;\n  const taskDuration = Math.pow(numberOfSubtasks, restDepth);\n\n  let prevTaskId: string | null = null;\n\n  for (let j = 0; j < numberOfSubtasks; ++j) {\n    const taskId = `${parentId}/task_${j + 1}`;\n    const taskName = `${parentName}.${j + 1}`;\n\n    const startDate = addDays(parentStartDate, j * taskDuration);\n    const endDate = addDays(parentStartDate, (j + 1) * taskDuration);\n\n    const task: Task = {\n      start: startDate,\n      end: endDate,\n      name: taskName,\n      id: taskId,\n      progress: 45,\n      type: \"task\",\n      parent: parentId,\n      dependencies: prevTaskId\n      ? [\n        {\n          ownTarget: \"startOfTask\",\n          sourceTarget: \"endOfTask\",\n          sourceId: prevTaskId,\n        },\n      ]\n      : undefined,\n    };\n\n    prevTaskId = taskId;\n    res.push(task);\n\n    if (restDepth > 0) {\n      initSubtasks(\n        res,\n        taskId,\n        startDate,\n        taskName,\n        currentDepth + 1,\n        numberOfSubtasks,\n        depth,\n      );\n    }\n  }\n};\n\nconst initTasks = (\n  numberOfRoots: number,\n  numberOfSubtasks: number,\n  depth: number,\n) => {\n  const res: Task[] = [];\n\n  const firstStartDate = new Date();\n  const firstEndDate = addDays(firstStartDate, Math.pow(numberOfSubtasks, depth));\n\n  for (let i = 0; i < numberOfRoots; ++i) {\n    const projectStartDate = addDays(firstStartDate, i);\n    const projectEndDate = addDays(firstEndDate, i);\n\n    const projectId = `project_${i + 1}`;\n    const projectName = `Project #${i + 1}`;\n\n    const project: Task = {\n      start: projectStartDate,\n      end: projectEndDate,\n      name: projectName,\n      id: projectId,\n      progress: 25,\n      type: \"project\",\n    };\n\n    res.push(project);\n\n    initSubtasks(\n      res,\n      projectId,\n      projectStartDate,\n      `Task #${i + 1}`,\n      1,\n      numberOfSubtasks,\n      depth,\n    );\n  }\n\n  return res;\n};\n\nexport const StressTest: React.FC<AppProps> = ({\n  numberOfRoots,\n  numberOfSubtasks,\n  depth,\n}) => {\n  const [tasks, setTasks] = useState<readonly TaskOrEmpty[]>(() => initTasks(\n    numberOfRoots,\n    numberOfSubtasks,\n    depth,\n  ));\n\n  useEffect(() => {\n    setTasks(initTasks(\n      numberOfRoots,\n      numberOfSubtasks,\n      depth,\n    ));\n  }, [\n    numberOfRoots,\n    numberOfSubtasks,\n    depth,\n  ]);\n\n  const onChangeTasks = useCallback<OnChangeTasks>((nextTasks, action) => {\n    switch (action.type) {\n      case \"delete_relation\":\n        if (window.confirm(`Do yo want to remove relation between ${action.payload.taskFrom.name} and ${action.payload.taskTo.name}?`)) {\n          setTasks(nextTasks);\n        }\n        break;\n\n      case \"delete_task\":\n        if (window.confirm('Are you sure?')) {\n          setTasks(nextTasks);\n        }\n        break;\n\n      default:\n        setTasks(nextTasks);\n        break;\n    }\n  }, []);\n\n  const handleDblClick = useCallback((task: Task) => {\n    alert(\"On Double Click event Id:\" + task.id);\n  }, []);\n\n  const handleClick = useCallback((task: Task) => {\n    console.log(\"On Click event Id:\" + task.id);\n  }, []);\n\n  return (\n    <DndProvider backend={HTML5Backend}>\n      <Gantt\n        onAddTask={onAddTask}\n        onChangeTasks={onChangeTasks}\n        onDoubleClick={handleDblClick}\n        onEditTask={onEditTask}\n        onClick={handleClick}\n        tasks={tasks}\n      />\n    </DndProvider>\n  );\n};\n","import { Meta, Story } from '@storybook/addon-docs';\n\nimport { Gantt } from '../src';\n\nimport { StressTest } from './StressTest';\n\n<Meta\n  title=\"StressTest\"\n  component={Gantt}\n  argTypes={{\n    numberOfRoots: {\n      control: 'number',\n    },\n    numberOfSubtasks: {\n      control: 'number',\n    },\n    depth: {\n      control: 'number',\n    },\n  }}\n  args={{\n    numberOfRoots: 4,\n    numberOfSubtasks: 4,\n    depth: 4,\n  }}\n/>\n\nexport const Template = (props) => {\n  return <StressTest {...props} />;\n}\n\n# Stress test example\n\n<Story name=\"StressTest\">\n  {Template.bind({})}\n</Story>\n"],"names":["initSubtasks","__name","res","parentId","parentStartDate","parentName","currentDepth","numberOfSubtasks","depth","restDepth","taskDuration","prevTaskId","j","taskId","taskName","startDate","addDays","endDate","task","undefined","initTasks","numberOfRoots","firstStartDate","firstEndDate","i","projectStartDate","projectEndDate","projectId","projectName","project","StressTest","tasks","setTasks","useState","useEffect","onChangeTasks","useCallback","nextTasks","action","handleDblClick","alert","handleClick","console","_jsx","DndProvider","HTML5Backend","onAddTask","Template","props","_createMdxContent","_components","Object","assign","h1","_provideComponents","components","_jsxs","_Fragment","children","Meta","title","component","Gantt","argTypes","control","args","Story","name","bind","MDXContent","wrapper","MDXLayout","stressTest","storyName","parameters","storySource","source","componentMeta","includeStories","mdxStoryNameToKey","docs","page","_jsx2","AddContext","__namedExportsOrder"],"mappings":"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"}